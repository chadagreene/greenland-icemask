

% Ice masks: 
fn = '/Users/cgreene/Documents/data/coastlines/greenland-coastlines-greene/greenland_monthly_ice_masks_2023-02-22.nc';
xx = double(ncread(fn,'x'));
yy = double(ncread(fn,'y'));
t = ncdateread(fn,'time');
t = datetime(1972,9,15):calmonths(1):datetime(2022,02,15);

tdn = datenum(t); 

D = load('terminus_data_densified_2023-01-09.mat');
color = parula(7); 

%%
kd = 4
   clear A
   close all
   
   S_tmp = m_shaperead(['/Users/cgreene/Documents/data/coastlines/AutoTerm/GID',num2str(kd),'.shp']);
   t_tmp = S_tmp.dbfdata(:,1);
   
   for sk = 1:length(t_tmp)
   
      [A(sk,1).X,A(sk,1).Y] = ll2psn(S_tmp.ncst{sk}(:,2),S_tmp.ncst{sk}(:,1)); 
   
   end
   
   for k=1:length(A) 
      A(k).X = A(k).X'; 
      A(k).Y = A(k).Y'; 
   end
   
   
   buf = 10e3; 
   xl = [min([A.X]) max([A.X])] + buf*[-1 1];
   yl = [min([A.Y]) max([A.Y])] + buf*[-1 1];
   
   %
   
   % Region of rows and columns of pixels to read: 
   ci=find((yy>=yl(1))&(yy<=yl(2)));
   ri=find((xx>=xl(1))&(xx<=xl(2)));
   
   x = xx(ri); 
   y = yy(ci); 
   
   ice = permute(logical(ncread(fn,'ice',[ri(1) ci(1) 1],[length(ri) length(ci) Inf])),[2 1 3]);
   rock = permute(logical(ncread(fn,'rock',[ri(1) ci(1)],[length(ri) length(ci)])),[2 1]);



sometimes_ice = any(ice,3) & ~all(ice,3); 
ice_sum = sum(ice(:,:,154:586),3); 
[X,Y] = meshgrid(x,y); 

flicker = sum(abs(double(ice(:,:,1:end-1))-double(ice(:,:,2:end))),3);

figure
%subsubplot(1,2,1) 
imagescn(x,y,ice_sum)
axis image 
hold on
ax = gca; 
axis off
set(gca,'pos',[0 0 1 1])
bedmachine('gl','color',rgb('gray'),'linewidth',.3,'greenland')

disableDefaultInteractivity(gca)

% subsubplot(1,2,2) 
% imagescn(x_tmp,y_tmp,flicker)
% axis image 
% ax(2)  = gca; 
% linkaxes(ax,'xy'); 
% axis off

%% 2 

trim = sometimes_ice & inpolygon_map(x,y,[-262514     -261771     -261212     -260873     -261276     -261707     -262459     -263384],[-1983562    -1983269    -1983104    -1982994    -1982197    -1981748    -1981445    -1982169]); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-263412	-262477	-261276	-260085	-259012	-258930	-259104	-259507	-259938	-260231	-260543	-261102	-261560	-262092	-262422	-263467],[-1984305	-1984204	-1984021	-1983654	-1983306	-1983022	-1982673	-1982407	-1982224	-1982032	-1981903	-1981867	-1981656	-1981408	-1981390	-1981647]); 

for k = 154:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-258673	-258857	-259269	-259755	-260121	-260616	-261212	-261386	-261900	-262147	-262266	-260763	-259617	-258673],[-1982563	-1982132	-1981812	-1981573	-1981473	-1981491	-1981335	-1981344	-1981207	-1981243	-1981738	-1983737	-1983517	-1982847]); 

for k = 334:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-258847	-257802	-257867	-258288	-258582	-258701	-259241	-259626	-259773	-260277	-260836	-262486],[-1982600	-1981363	-1981088	-1980831	-1980593	-1980409	-1980061	-1980006	-1980070	-1979905	-1979529	-1981225]); 

for k = 406:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 4

trim = sometimes_ice & inpolygon_map(x,y,[-307823     -308087     -308290     -307477     -307193     -307112     -307234],[-1853565    -1853646    -1854682    -1855514    -1855230    -1854337    -1853849]); 
trim = trim | (sometimes_ice & inpolygon_map(x,y,[ -308330     -308087     -307416     -307396     -308087     -308757],[-1853423    -1853098    -1852915    -1852408    -1852002    -1852530])); 
trim = trim | (sometimes_ice & inpolygon_map(x,y,[ -305386     -306503     -306909     -306056],[-1844103    -1843534    -1844692    -1845788])); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-307296	-306821	-306362	-305912	-305620	-304878	-304611	-304335	-303977	-303952	-304102	-304310	-304152	-304444	-304777	-305144	-305470	-305711	-306229],[-1851609	-1852218	-1852526	-1852727	-1852727	-1852451	-1852143	-1851709	-1850975	-1850450	-1849649	-1849341	-1849049	-1848465	-1848206	-1848081	-1847956	-1847856	-1847781]);
for k = 154:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-306866	-308673	-308071	-307296	-306239	-306140	-306202	-306054	-305722	-305095	-304345	-304050	-303853	-303337	-302931	-302981	-303017	-302710	-302685	-302550	-302587	-302796	-303263	-303731	-304149	-304198	-303853	-303866	-304161	-304899	-305169	-305784],[-1851180	-1852348	-1854180	-1855348	-1855372	-1854499	-1854081	-1853528	-1852926	-1853245	-1853122	-1852741	-1852348	-1852040	-1851671	-1851339	-1851057	-1850626	-1850270	-1850024	-1849593	-1849421	-1849446	-1849471	-1849384	-1849139	-1848573	-1848389	-1848241	-1848007	-1847675	-1847761]);
for k = 273:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-305049	-304877	-304597	-304301	-304140	-304016	-303860	-303548	-303320	-303107	-302988	-302827	-302827	-302998	-303009	-302874	-302744	-302624	-302500	-302391	-302406	-302557	-302521	-302733	-303393	-305121],[-1853455	-1853678	-1853736	-1853611	-1853611	-1853652	-1853761	-1853845	-1853761	-1853725	-1853658	-1853393	-1853258	-1852910	-1852682	-1852557	-1852479	-1852324	-1852178	-1851903	-1851737	-1851540	-1850927	-1850636	-1850730	-1852812]); 
trim = trim | (sometimes_ice & inpolygon_map(x,y,[ -306521     -305160     -305211     -305047     -305353     -305483     -305985],[-1847809    -1847767    -1847382    -1847034    -1846795    -1846021    -1845870]));
for k = 326:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-306107	-305576	-305300	-305201	-304945	-304650	-304227	-303459	-303311	-303203	-303055	-302878	-302711	-302455	-302051	-302248	-302602	-304207	-306117	-306393],[-1854197	-1854226	-1854069	-1854059	-1854325	-1854374	-1854384	-1854393	-1854206	-1853852	-1853685	-1853527	-1853281	-1852759	-1852218	-1851962	-1851735	-1852287	-1853133	-1854364]);
for k = 404:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-305674	-305093	-304630	-304217	-304099	-303410	-303045	-303016	-303095	-302819	-302366	-302100	-301362	-301460	-301963	-302071	-303134	-306255],[-1854393	-1854561	-1854364	-1854413	-1854581	-1854787	-1854403	-1854108	-1853704	-1853507	-1853852	-1853813	-1852936	-1852621	-1852100	-1851509	-1851420	-1854305]); 
for k = 452:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[-306315	-304606	-304314	-303994	-303528	-303108	-302989	-302989	-303080	-302825	-302377	-302048	-301719	-301399	-301262	-301344	-301737	-302578	-306726],[-1855518	-1854869	-1854741	-1855088	-1854951	-1854960	-1854650	-1854211	-1853782	-1853499	-1853864	-1854065	-1853809	-1853343	-1852859	-1852640	-1852338	-1852119	-1854092]);
trim = trim | (sometimes_ice & inpolygon_map(x,y,[ -304289     -303763     -304835     -304775     -305088     -305614     -306181],[-1849127    -1848388    -1847387    -1847149    -1846704    -1846213    -1848778]));
trim = trim | (sometimes_ice & inpolygon_map(x,y,[  -305603     -305040     -304660     -304551     -304450     -305739],[-1845979    -1845633    -1845381    -1844927    -1844713    -1843875]));
for k = 326:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 9

trim = sometimes_ice & X>-318146 & X<-314490 & Y>-1826849 & Y<-1823349 & ice_sum<86 ;
for k = 1:239
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 10

trim = sometimes_ice & ice_sum<433 & inpolygon_map(x,y,[-322183     -321592     -322678     -323954     -323935],[-1807295    -1805943    -1805638    -1805314    -1806762]); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 27 

trim = ~ice(:,:,248) & sometimes_ice & ice_sum<433 & inpolygon_map(x,y,[-367902     -364253     -358703     -359615     -362884],[ -1578989    -1582790    -1581270    -1575796    -1575872]); 

for k = 248:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~ice(:,:,331) & ~ice(:,:,333) & sometimes_ice & ice_sum<433 & inpolygon_map(x,y,[-367902     -364253     -358703     -359615     -362884],[ -1578989    -1582790    -1581270    -1575796    -1575872]); 

for k = 331:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 36

trim = sometimes_ice & ice_sum<300 & inpolygon_map(x,y,[-378634     -373851     -373375     -374803     -377777],[-1496243    -1496410    -1494173    -1492745    -1492817]); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 37
trim = sometimes_ice & ice_sum<200 & inpolygon_map(x,y,[-385219     -382166     -380802     -380750     -382803     -385271],[-1482959    -1482907    -1481335    -1479503    -1479218    -1479672]); 

for k = 1:384
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & ice_sum<290 & ~ice(:,:,385) & inpolygon_map(x,y,[-385219     -382166     -380802     -380750     -382803     -385271],[-1482959    -1482907    -1481335    -1479503    -1479218    -1479672]); 

for k = 385:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 39 tongue 

trim = sometimes_ice & ice_sum<100 & inpolygon_map(x,y,[ -388348     -388950     -389837     -390361     -391191     -390224     -387745],[  -1476823    -1477028    -1477619    -1478233    -1479223    -1479928    -1476971]); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 40 

trim = sometimes_ice & ice_sum<230 & ~ice(:,:,122) & inpolygon_map(x,y,[ -390876     -394700     -396164     -393480     -388273],[ -1462088    -1465206    -1466888    -1469301    -1468732]); 
trim = trim | (sometimes_ice & ice_sum<300& inpolygon_map(x,y,[-395475     -395486     -394811     -394764],[ -1466838    -1467496    -1467543    -1466826 ])); 

for k = 122:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 48

trim = sometimes_ice & ice_sum<260 & ~ice(:,:,380) & inpolygon_map(x,y,[-439894     -439527     -436162     -434052     -436162 ],[-1423335    -1432053    -1431471    -1426118    -1422448]); 

for k = 380:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 53 total failure 

trim = ~rock & inpolygon_map(x,y,[-459127	-460303	-460348	-458293	-457807	-457587	-457382	-457306	-456942	-456601	-457109	-457276	-457511	-457739	-458156	-458384	-458793	-458991],[-1408151	-1409646	-1411133	-1411649	-1411322	-1411163	-1410784	-1410541	-1410412	-1408599	-1408629	-1408296	-1408015	-1407954	-1407742	-1407947	-1408015	-1408000]); 

for k = 313:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[-459135	-459157	-456700	-456646	-457064	-457284	-457686	-457989	-458338	-458672	-459059],[-1407651	-1408159	-1409100	-1407363	-1407378	-1407264	-1407180	-1407218	-1407256	-1407370	-1407423]); 

for k = 332:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


trim = ~rock & inpolygon_map(x,y,[-459499	-456730	-456760	-456965	-456995	-457246	-457784	-458149	-458513	-458634	-458960	-459089	-459112	-459264	-459233	-459173	-459142	-459438],[-1407886	-1408030	-1405845	-1405512	-1405352	-1405155	-1405056	-1405094	-1405216	-1405428	-1405587	-1405845	-1406058	-1406612	-1406983	-1407135	-1407363	-1407522]); 

for k = 396:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[-458748	-458717	-456730	-456677	-456829	-457208	-457617	-458035	-458422	-458611],[-1405041	-1405580	-1405754	-1405269	-1405011	-1404761	-1404632	-1404601	-1404707	-1404897]); 

for k = 443:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[-458748	-456639	-456214	-456320	-456715	-457147	-457451	-457625	-458103	-458490	-458657	-458771],[-1405094	-1405367	-1404844	-1404131	-1403926	-1403888	-1403865	-1404047	-1403987	-1403956	-1404230	-1404503]); 

for k = 467:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 60 

filler = sometimes_ice & inpolygon_map(x,y,[ -524269     -524245     -522356     -521734     -520921     -523719],[-1403707    -1404544    -1408060    -1408395    -1408012    -1403803]); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

%% 63

filler = sometimes_ice & inpolygon_map(x,y,[-553586     -553608     -552135     -551920     -552957],[ -1383762    -1384026    -1384059    -1383629    -1383657]);

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

%% 64

filler = sometimes_ice & inpolygon_map(x,y,[-568553	-568115	-567360	-567754	-567841	-567885	-568039	-568280	-568838	-568849],[-1386506	-1386418	-1386298	-1385772	-1385640	-1385137	-1384874	-1384622	-1384709	-1385936]);

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

%% 65
% some flicker remains in later years. 

trim = sometimes_ice & ice_sum<590 & inpolygon_map(x,y,[ -570454     -571455     -571788     -570909     -566725     -568847     -569484     -569848],[-1391790    -1392882    -1394034    -1395004    -1390698    -1389364    -1390031    -1391365]);

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 68

trim = sometimes_ice & ice_sum<590 & inpolygon_map(x,y,[-569886     -570042     -565293     -565395     -565476     -565788     -565881],[ -1331144    -1331579    -1332287    -1331434    -1331068    -1330565    -1329173]); 
for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 70

trim = sometimes_ice & ice_sum<590 & inpolygon_map(x,y,[-591095     -588758     -589531     -589550     -589801     -589743     -591153],[-1287004    -1287120    -1286522    -1285672    -1285150    -1284610    -1285092]); 
trim = trim | (ice_sum<10 & inpolygon_map(x,y,[ -591230     -588527     -588082     -591481],[ -1287333    -1287275    -1283663    -1283683])); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 84

trim = sometimes_ice & ~ice(:,:,71) & inpolygon_map(x,y,[ -599056     -594851     -594956     -599612],[  -1139474    -1138570    -1136034    -1136763]); 

for k=1:70
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 85 Humboldt 

trim = sometimes_ice & ice_sum<310 & inpolygon_map(x,y,[ -398812     -398754     -411675     -411501     -408125],[-1086615    -1082424    -1087837    -1091970    -1096917]); 
trim =  trim | (sometimes_ice & ice_sum<400 & inpolygon_map(x,y,[ -403992     -403294     -398870     -398870],[-1083646    -1089059    -1086964    -1082482]));

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 97 

trim = sometimes_ice & ice_sum<260 & inpolygon_map(x,y,[188301	188852	189402	189677	189585	189524	189096	188301	191756	193895	196402	196127	192520	190319],[-869117	-869759	-870768	-871655	-872480	-873152	-873703	-874406	-875445	-875903	-871960	-869056	-869331	-868475]); 

trim = trim | inpolygon_map(x,y,[187829      189301      195055      195055      191523],[ -869089     -870079     -870882     -867697     -867322]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 102 Zach. 


filler = ~rock & inpolygon_map(x,y,[522643      523691      524668      523375      522485],[-1084531    -1084230    -1083425    -1082319    -1083440]); 

for k = 1:382
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[499400	498760	498133	498091	499526	499790	500515	499289	499790	502130	503843	505292	505375	505278	505347	505097	505013	504345	503467	503342	503425	503746	503620	503760	503049	502854	502659	502283	501907	501239	501044	500654	499985	499609],[-1106474	-1107309	-1108813	-1110610	-1110652	-1110972	-1110680	-1112184	-1113925	-1116613	-1117114	-1117226	-1116543	-1116195	-1115638	-1114774	-1114301	-1113646	-1113618	-1113047	-1112811	-1112644	-1112045	-1111683	-1109635	-1108911	-1107449	-1107059	-1107156	-1107170	-1107323	-1106891	-1106488	-1106320]); 
trim = trim | (sometimes_ice & inpolygon_map(x,y,[503649	504088	505922	507139	506896	506328	505873	505321	505321	503795],[-1117178	-1118347	-1119061	-1118607	-1117958	-1118087	-1117925	-1117503	-1116756	-1116740])); 
trim = trim | (sometimes_ice & inpolygon_map(x,y,[522093	520698	520883	521469	522669	523381	524279	524767	525011	525431	525577	525441	522454],[-1080417	-1083364	-1084057	-1084467	-1083218	-1082330	-1081266	-1080729	-1080485	-1080427	-1080388	-1079373	-1079997])); 
trim = trim | (~rock & inpolygon_map(x,y,[518803	518422	518625	518143	519006	519603	520390	520797	521381	521483	521724	521292	518613],[-1059779	-1062332	-1063106	-1066027	-1064973	-1064084	-1061900	-1060287	-1059411	-1058446	-1058002	-1056655	-1057709])); 
trim = trim | (~rock & inpolygon_map(x,y,[499914	500263	501147	501484	501945	502468	502754	503004	502555	502181	501621	500201],[-1085604	-1085841	-1084869	-1084919	-1084222	-1083935	-1083287	-1082590	-1081817	-1080584	-1080223	-1082440])); 
trim = trim | (~rock & inpolygon_map(x,y,[489474	490348	491077	491534	492304	492845	494011	494656	495446	495967	496570	497444	497527	497985	498380	498859	493053	488725	488704],[-1085640	-1085016	-1085161	-1085785	-1086139	-1085848	-1086327	-1086992	-1087513	-1087263	-1087346	-1087450	-1086930	-1086597	-1086763	-1085869	-1083871	-1083288	-1085869])); 
trim = trim | (~rock & inpolygon_map(x,y,[518906      520178      520558      523277      522425      521050      519860],[-1108079    -1109269    -1109957    -1108633    -1107750    -1107720    -1107104])); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[501796	502350	503121	503242	504736	504591	505940	512325	508880	508061	507049	505940	504663	502928	501868	500447	500061	500085	500688	501531	501892],[-1107364	-1111316	-1112954	-1113822	-1117123	-1118159	-1120327	-1116255	-1113195	-1112737	-1111051	-1108690	-1107870	-1105967	-1105268	-1104329	-1104521	-1104979	-1105413	-1106617	-1107268]); 
trim = trim | (~rock & inpolygon_map(x,y,[515841	516776	516722	516343	516627	516695	517156	517495	517441	518376	518701	518959	523458	521019	519839	519026	518687	518728	517183	516695	516411	516058],[-1107514	-1107867	-1108192	-1108273	-1108477	-1108951	-1109344	-1109629	-1110496	-1111187	-1112719	-1113003	-1108626	-1107758	-1107081	-1105563	-1105888	-1106091	-1106864	-1106945	-1106796	-1106904])); 
trim = trim | (~rock & inpolygon_map(x,y,[],[])); 
trim = trim | (~rock & inpolygon_map(x,y,[],[])); 
trim = trim | (~rock & inpolygon_map(x,y,[],[])); 

for k=217:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[513609	514153	514718	514948	514927	515240	515470	516934	517812	518544	518983	521638	521973	521826	516348	513421],[-1063623	-1063832	-1063309	-1063853	-1064793	-1066111	-1066821	-1067177	-1064814	-1064689	-1065191	-1060570	-1060361	-1058019	-1058835	-1061427]);
for k=218:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[512625      513455      513899      514285      514903      515636      514941      512297],[ -1066122    -1066353    -1064867    -1065408    -1065350    -1064095    -1062628    -1063091]); 
trim = trim | (~rock & inpolygon_map(x,y,[520886      521909      522180      524535      525249      519921],[ -1061682    -1060775    -1060872    -1059482    -1057802    -1056162])); 
for k=278:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[506651      505511      510414      518999      516853      514759      512242      509990      508294],[ -1109618    -1109618    -1118388    -1116454    -1114255    -1113089    -1112930    -1111499    -1111102]);
trim = trim | (~rock & inpolygon_map(x,y,[511685	514229	515634	516906	521914	521410	519502	519317	517674	516535	514547],[-1103682	-1105961	-1107392	-1107736	-1107736	-1106597	-1104954	-1104132	-1103232	-1103974	-1103232])); 
for k=325:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[509794      509740      511891      513752      516679      517944      517095      513951      510861],[-1100691    -1101486    -1104305    -1106437    -1109022    -1103420    -1101504    -1100004    -1100944]);
for k=336:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[499456	510096	523604	523537	520869	518901	516966	514165	513031	512063	511396	508661	506660	506227	504992	502791	503625	503425	502157	501290	500923	500490	500123	498388],[-1106593	-1118934	-1119334	-1104358	-1102691	-1101190	-1100989	-1099722	-1098588	-1097854	-1096420	-1094952	-1094752	-1095453	-1095953	-1098555	-1098588	-1100189	-1100823	-1102924	-1103558	-1103558	-1104325	-1104658]); 
trim = trim | (~rock & inpolygon_map(x,y,[512351	513529	513576	514188	514470	514988	515318	515483	516072	515695	515954	516401	517602	518685	519345	519627	520051	520475	521111	521322	522829	523936	527751	528363	514635	511574],[-1068414	-1067189	-1066342	-1066389	-1065682	-1065894	-1067284	-1067142	-1067731	-1068885	-1069733	-1069285	-1064811	-1064599	-1066083	-1066295	-1065117	-1065518	-1065329	-1065047	-1064788	-1065847	-1067095	-1056688	-1060385	-1062810]));
for k=360:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[523989	525152	525613	526008	526017	525370	524692	528932	528860	523400],[-1081698	-1080729	-1080866	-1081706	-1082223	-1083265	-1084113	-1084525	-1078621	-1078726]); 
for k=371:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[497913	499591	521770	521028	520188	519769	512699	509115	506629	506242	506016	504595	504111	503143	503046	501851	501851	500915	500011	499882	498849	498332	498300	499430	498429	497945	498074],[-1110550	-1110647	-1105224	-1102576	-1101995	-1099671	-1095894	-1094506	-1094247	-1095054	-1095442	-1096055	-1096217	-1096927	-1097831	-1099380	-1100123	-1100930	-1101317	-1102738	-1103674	-1103965	-1104901	-1106483	-1106806	-1108969	-1109550]); 
trim = trim | (~rock & inpolygon_map(x,y,[520925	520793	521455	522348	522646	523391	523771	523490	528206	527991	521968],[-1084075	-1084422	-1084654	-1083512	-1083562	-1084985	-1085134	-1085944	-1085531	-1079292	-1080037]));
for k=383:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[504870	504287	519634	519736	519457	517326	516032	514485	512886	512886	511922	510679	509462	507432	506088	506265	505885],[-1094615	-1096162	-1100424	-1097685	-1095985	-1094742	-1093955	-1094818	-1095148	-1094437	-1094843	-1094945	-1094666	-1093829	-1093955	-1094361	-1094818]); 
for k=396:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


trim = ~rock & inpolygon_map(x,y,[503071	504884	519446	519036	517048	515791	512808	511287	510732	508071	506112	503129],[-1094029	-1094731	-1096573	-1095228	-1094555	-1093473	-1093356	-1093005	-1093035	-1092099	-1091485	-1093473]);
trim = trim | (~rock & inpolygon_map(x,y,[513934	515129	516213	517130	518825	519464	519992	520798	521243	522577	523661	523827	526718	526551	515296],[-1065248	-1069389	-1069834	-1068805	-1066165	-1066138	-1067082	-1066582	-1065943	-1065582	-1065943	-1067082	-1067527	-1061802	-1062247]));
for k=408:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


trim = ~rock & inpolygon_map(x,y,[498125	521494	521087	520311	519202	519460	519423	519091	514062	513803	513211	512731	512176	510808	509883	503228	502895	503117	502192	500159	499604	498901	498680	498125	498125	497866	498273	498680	498125],[-1109552	-1105151	-1101860	-1101823	-1095353	-1094502	-1093763	-1093060	-1091322	-1091137	-1089288	-1089251	-1088364	-1088253	-1088882	-1092210	-1093319	-1094243	-1095501	-1098976	-1100160	-1101380	-1102748	-1103635	-1104227	-1105151	-1106261	-1106741	-1108110]);
trim = trim | (~rock & inpolygon_map(x,y,[ 513067      513814      514864      515453      514792      513125],[-1067702    -1067759    -1068478    -1068262    -1066034    -1066034]));
for k=432:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[ 502114      503599      511373      510364      509668      506166      504204],[-1091565    -1092519    -1088375    -1088119    -1087532    -1089567    -1090612]); 
for k=444:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[ 505130      509824      509718      508271      507901      507389      506047      505889],[-1090191    -1089556    -1087597    -1087509    -1087667    -1087103    -1088056    -1088550]); 
for k=455:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[498095	503355	512003	510061	508473	506567	505296	502966	500919	498730	497460	497813	498519	498448	497813	497601	497883	498025],[-1104057	-1103492	-1088279	-1087467	-1087714	-1086902	-1086020	-1086584	-1087573	-1088879	-1092832	-1093997	-1094103	-1094915	-1096150	-1098127	-1099962	-1101727]); 
for k=456:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[503992	500945	499590	499026	497474	496035	495161	494596	494258	494286	494060	494089	494427	494568	495132	495640	496007	496346	497023	497587	498095	497785	497785	498434	501227],[-1086357	-1086273	-1086724	-1087401	-1088220	-1089376	-1090505	-1092000	-1092621	-1093185	-1093496	-1094117	-1095019	-1095922	-1097051	-1098038	-1098687	-1099731	-1100832	-1101904	-1102920	-1103286	-1103766	-1104330	-1103907]); 
for k=480:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[497213	496807	495690	493997	493658	493184	492947	493015	492947	493286	493794	493929	495216	495791	496028	496468	496401	496604	496705	497179	497518	498060	497823	497789	498263	498635	498500	498161	498026	498229	498432	497857	497450	497823	498398	499346	499888	501750],[-1088521	-1088216	-1088352	-1088826	-1089740	-1090011	-1091230	-1091805	-1093193	-1094412	-1095699	-1096139	-1097189	-1098441	-1100033	-1101522	-1102233	-1102606	-1103215	-1103520	-1103554	-1104299	-1105078	-1105653	-1106364	-1106770	-1107143	-1108091	-1108870	-1109479	-1109750	-1109987	-1110393	-1111544	-1112188	-1112086	-1110901	-1109716]); 
for k=492:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


trim = trim | (~rock & inpolygon_map(x,y,[],[])); 
trim = trim | (~rock & inpolygon_map(x,y,[],[])); 
trim = trim | (~rock & inpolygon_map(x,y,[],[])); 

%% 108 

%trim = sometimes_ice &  inpolygon_map(x,y,[],[]); 
trim = sometimes_ice &  inpolygon_map(x,y,[  604352      604527      605295      605723      605681],[-1437733    -1438629    -1438649    -1437984    -1437616]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 121 

trim = sometimes_ice &  inpolygon_map(x,y,[586407      586035      585553      585954      587119      586718],[  -2056048    -2056572    -2057342    -2057738    -2056166    -2055898]); 
for k=1:157
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ice_sum>0 &  inpolygon_map(x,y,[588946      588642      588981      589527      589335],[-2060549    -2061322    -2061691    -2060683    -2060541]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 123 

trim = ice_sum>0 &  inpolygon_map(x,y,[605339	605363	606319	606845	608160	611315	614853	610551	608949	608566	608423	608088	607562	606702	606224],[-1971757	-1972498	-1974124	-1975128	-1976323	-1979264	-1974267	-1969463	-1970036	-1970299	-1970801	-1971255	-1971662	-1972020	-1971829]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 127 

trim = ice_sum>0 &  inpolygon_map(x,y,[729451	729458	729780	730460	731118	731170	730729	729825],[-2026156	-2027397	-2028331	-2028787	-2028697	-2028271	-2026567	-2026111]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end
%% 128 

trim = ice_sum>0 &  inpolygon_map(x,y,[781668	781968	782340	782640	782981	783291	783581	784005	784118	784222	784263	784294	784511	784449	783084],[-2025499	-2026398	-2026305	-2026419	-2026688	-2026915	-2026967	-2026626	-2026347	-2026078	-2025757	-2025592	-2025396	-2024320	-2024351]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 138
trim = ice_sum>0 &  inpolygon_map(x,y,[708446	708391	710397	710807	710160	709732	709604	709713	709558	709294	709157	709057	708875	708711	708610],[-2231889	-2232071	-2233530	-2232992	-2230613	-2230485	-2230604	-2230786	-2231014	-2231142	-2231342	-2231388	-2231670	-2231716	-2231853]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 139
trim = ice_sum>0 &  inpolygon_map(x,y,[704979      704491      704159      703758      703496      703741      705136      705363],[  -2233012    -2233099    -2233134    -2233309    -2233518    -2234216    -2233727    -2233221]); 

for k=188:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ice_sum>0 &  inpolygon_map(x,y,[704811	704690	704359	704004	703665	703584	703382	703213	703067	703415	703826	705110	705029],[-2232576	-2232665	-2232714	-2232819	-2232875	-2233053	-2233247	-2233327	-2233465	-2234232	-2234167	-2233255	-2232722]); 

for k=298:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 141
trim = ice_sum>0& sometimes_ice &  inpolygon_map(x,y,[ 668695      668729      669911      669658      670633      670094      669670      669498      669372],[-2261073    -2263665    -2263722    -2262243    -2261578    -2261268    -2261142    -2261027    -2260844]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 150
trim = ice_sum>0&  inpolygon_map(x,y,[504721	504477	504404	504319	504197	504209	504099	503965	504258	505662	508054	507896	507896	507847	507725	507542	507359	507139	507053	507224	507383	507554	507627	507700	507591	507444	507273	507066	506907	504892],[-2285430	-2285504	-2285662	-2285833	-2285992	-2286285	-2286456	-2286578	-2287091	-2287750	-2287933	-2287726	-2287579	-2287481	-2287323	-2287262	-2287176	-2287079	-2286822	-2286651	-2286358	-2286126	-2285968	-2285797	-2285650	-2285577	-2285565	-2285382	-2285125	-2285235]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 155 weird big area 

trim = ice_sum>0 & ice_sum<300 &  inpolygon_map(x,y,[  516062      516869      533800      532662      526822],[  -2327945    -2334446    -2336319    -2326623    -2324640]); 

trim = trim |(ice_sum>0 & inpolygon_map(x,y,[528891	529039	529280	529658	529958	530318	530801	531143	531509	531656	529227	528767],[-2334512	-2334654	-2334895	-2334978	-2335013	-2335049	-2334960	-2334889	-2334648	-2334394	-2332838	-2333592]));
trim = trim |(ice_sum>0 & inpolygon_map(x,y,[517878	517984	518014	518014	518279	518621	518827	519146	519275	519423	519741	519299],[-2332561	-2332885	-2332926	-2332991	-2333121	-2333215	-2333221	-2333162	-2333056	-2333009	-2332649	-2331765]));

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 164 island after Aug 1999 

trim = sometimes_ice & ice_sum>260 & inpolygon_map(x,y,[489486      490164      490172      489453],[ -2450823    -2450864    -2450259    -2450276]); 

for k=324:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 165 a couple of bad picks, apparently 

trim = sometimes_ice & ice_sum<120 & inpolygon_map(x,y,[478352	478260	478220	477954	477934	477995	478015	478873	479914	478546],[-2476986	-2477098	-2477374	-2477466	-2477670	-2478007	-2478180	-2478231	-2476802	-2476864]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 178 crazy long-fjord failure

trim = sometimes_ice & inpolygon_map(x,y,[362518	361632	356388	361606	361657	362189	362214	362442	362772	363228	363937	365508	365989	365888	365508	365356	365356	364672	363810	363050],[-2569641	-2569311	-2574555	-2576405	-2575721	-2575037	-2574707	-2574403	-2574302	-2574175	-2574378	-2573061	-2571034	-2570705	-2570299	-2569995	-2569615	-2569362	-2569387	-2569539]); 
for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[361954	366126	368258	367992	367472	366859	366286	365633	365233],[-2569495	-2571281	-2567736	-2567469	-2566936	-2566470	-2566310	-2565763	-2565657]); 

for k=257:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[365140	368232	369311	368952	368698	368392	367979	367205	366699	366179],[-2565883	-2568043	-2566083	-2565857	-2565497	-2565164	-2564950	-2564710	-2564524	-2564537]); 

for k=336:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[365714	369191	370936	370740	370490	369887	369427	369086	368469	367839],[-2564508	-2566463	-2563786	-2563130	-2562750	-2562317	-2562212	-2561949	-2561739	-2561779]); 

for k=437:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[367399	370825	370996	370953	371167	371456	372773	373812	373319	373169	372688	372120	372045	371638	371017	370589],[-2561733	-2563928	-2563424	-2562996	-2562846	-2562739	-2562793	-2561048	-2560523	-2560213	-2559763	-2559345	-2559099	-2558617	-2558510	-2558510]); 

for k=452:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[370632	373405	374272	374069	374122	374144	374176	374369	374529	374529	374112	373823	373630	373566	373330	372902	372538	372227	371853	371746	371339],[-2558553	-2561347	-2560320	-2559881	-2559174	-2558649	-2558467	-2558317	-2558082	-2557632	-2557236	-2557193	-2557375	-2557547	-2557611	-2557707	-2557846	-2557900	-2558093	-2558425	-2558510]);

for k=530:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 180 

trim = sometimes_ice & inpolygon_map(x,y,[ 337703      337753      338498      339209      339192      338261      337601],[ -2576801    -2577038    -2577411    -2577428    -2576784    -2575718    -2576243]);

for k=360:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 187

trim = sometimes_ice & inpolygon_map(x,y,[236432	236774	238944	239508	239434	239063	238691	238186	237621	237339	236878],[-2674990	-2675540	-2676610	-2676610	-2675971	-2675718	-2675020	-2674009	-2673979	-2674172	-2674470]); 

for k=418:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[236521	239508	239464	239033	238795	238513	238260	238201	237918	237636	237264	236952	236789	236863	236848	236744	236610],[-2674945	-2676149	-2675183	-2674678	-2674618	-2674633	-2673875	-2673637	-2673296	-2673162	-2673266	-2673429	-2673593	-2673831	-2673979	-2674187	-2674277]);

for k=526:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[236774      238260      238097      237353      237056      236729      236640      236774],[ -2674217    -2673771    -2673370    -2672984    -2672984    -2673147    -2673355    -2673860]);
for k=550:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 194 

trim = sometimes_ice & ice_sum<200 & inpolygon_map(x,y,[211052      212433      212274      211876      211807      211628      211151],[ -2725651    -2725661    -2725134    -2725085    -2724618    -2724429    -2724429]);

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 195 ack discovered rock error! 

rock(inpolygon_map(x,y,[205823      204685      204667      205236      207662      207251      207102      206051],[ -2720297    -2721847    -2722434    -2722802    -2721120    -2720148    -2719903    -2719903]))=false; 

trim = inpolygon_map(x,y,[204965	205175	207697	207286	207181	206962	206725	206550	206349	206130	205998	205928	205920	205753	205736	205718	205701	205622	205508	205280	205096	205000],[-2722627	-2722767	-2721243	-2720577	-2720262	-2720140	-2720087	-2720096	-2720069	-2720078	-2720236	-2720437	-2720560	-2720770	-2720989	-2721182	-2721374	-2721506	-2721690	-2721882	-2722163	-2722504]); 

for k=432:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 196 i think

trim = sometimes_ice & ice_sum<400 & inpolygon_map(x,y,[  184328      186978      187550      187505      187038      186481      186165      185728      184795],[ -2727870    -2729045    -2729060    -2727855    -2727359    -2726877    -2726832    -2726892    -2727283]);

for k=274:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & ice_sum<400 & inpolygon_map(x,y,[ 184599      184073      184584      186782      186300      185789      185141],[-2727494    -2728172    -2728533    -2727193    -2726621    -2726651    -2726967]); 

for k=322:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & ice_sum<400 & inpolygon_map(x,y,[183786	184253	186722	186316	186105	185759	185322	184825	184524	184193],[-2727615	-2728126	-2727027	-2726395	-2726260	-2726245	-2726335	-2726471	-2726621	-2726982]); 

for k=550:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & ice_sum<400 & inpolygon_map(x,y,[183531	183937	186361	186045	185427	185141	184946	184359	184073	183802],[-2727268	-2727630	-2726335	-2725929	-2725778	-2725959	-2726124	-2726305	-2726501	-2726892]); 

for k=574:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 198 another rock mask problem! 

rock(inpolygon_map(x,y,[189047	188947	188804	188826	188847	188755	189474	189923	190614	190977	191334	191612	191661	191013	189645],[-2755897	-2756367	-2756581	-2756837	-2757158	-2757500	-2757977	-2758162	-2758469	-2758176	-2757913	-2757599	-2757115	-2756281	-2755889])) = false; 

trim = inpolygon_map(x,y,[189018	188990	189232	189538	189723	190115	190365	190707	190928	191120	191270	191483	191170	189510	189189],[-2756816	-2757222	-2757350	-2757535	-2757699	-2757763	-2757842	-2757849	-2757777	-2757607	-2757300	-2757008	-2756224	-2755768	-2755804]); 

for k=382:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end
%% 209 

trim = sometimes_ice & ice_sum<209 & inpolygon_map(x,y,[177616	177718	180668	181217	180985	180761	180575	180361	180138	179896	179598],[-2819304	-2820682	-2820896	-2820114	-2819798	-2819602	-2819537	-2819519	-2819221	-2819025	-2819007]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & ice_sum<300 & inpolygon_map(x,y,[179598      181171      181590      181431      181115      180799      180501      180389      179812],[ -2818988    -2820263    -2819584    -2819416    -2819044    -2819053    -2818774    -2818523    -2818355]); 

for k=334:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 214 

trim = inpolygon_map(x,y,[198141	198323	198528	198733	199007	199178	199543	199896	200261	200603	200591	200227	199862],[-2847703	-2847862	-2847919	-2848113	-2848239	-2848250	-2848079	-2848068	-2848227	-2848284	-2847634	-2847327	-2847258]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = inpolygon_map(x,y,[198403	198745	198916	199166	199280	200044	200420	200705	200762	200660	199816],[-2847646	-2848136	-2848410	-2848706	-2848729	-2848592	-2848512	-2848489	-2848011	-2847634	-2847247]); 

for k=445:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = inpolygon_map(x,y,[197935	197867	198163	198357	198722	198995	199212	199269	200135	200284	200363	200648	200774],[-2847270	-2847669	-2847988	-2848033	-2848318	-2848683	-2849299	-2849686	-2849504	-2849299	-2848922	-2848717	-2847828]); 

for k=455:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 219

trim = sometimes_ice & inpolygon_map(x,y,[217304	217104	216871	216971	218291	219678	219900	219667	219501	219223	218857	218547	218214	217781	217681	217470],[-2889254	-2889565	-2889909	-2890108	-2890175	-2889587	-2889187	-2888877	-2888832	-2888688	-2888710	-2888810	-2889121	-2889165	-2889309	-2889199]); 

for k=442:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 226 

rock(inpolygon_map(x,y,[163116	163780	164014	164802	164374	164774	165576	165576	164885	164429	163862],[-2907470	-2907788	-2908078	-2910137	-2910634	-2911339	-2910496	-2909777	-2908520	-2907843	-2907249])) = false; 

filler = inpolygon_map(x,y,[163566	163939	164357	164633	164999	165288	165545	165494	165610	165622	165128	164903	164749	164627	164479	164337	164042	163714],[-2907508	-2910271	-2910657	-2911338	-2911183	-2910849	-2910535	-2910284	-2910021	-2909841	-2908986	-2908459	-2908440	-2908177	-2907913	-2907759	-2907489	-2907444]);

for k = 1:333
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

filler = inpolygon_map(x,y,[163560	163573	164003	164370	164485	164659	164903	165057	165327	165333	165256	165192	165340	165218	165076	164813	164723	164562	164498	164331	164190	163920],[-2907502	-2907785	-2910483	-2910650	-2910926	-2910830	-2910817	-2910811	-2910374	-2910233	-2910046	-2909731	-2909455	-2909314	-2908826	-2908485	-2908382	-2908177	-2907952	-2907727	-2907605	-2907476]);

for k = 334:453
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

%% 231 


trim = sometimes_ice & inpolygon_map(x,y,[97411       97741      100024       98810       98375       97966       97649       97438],[-3006240    -3006398    -3005369    -3004049    -3004458    -3004775    -3005197    -3005725]); 
for k=1:153
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


trim = sometimes_ice & inpolygon_map(x,y,[98507	98335	97926	97675	97411	97319	97279	97860	99813	100077	99140],[-3003851	-3004102	-3004300	-3004577	-3004907	-3005263	-3005857	-3006398	-3005976	-3005065	-3003970]); 

for k=154:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%%

trim = sometimes_ice & inpolygon_map(x,y,[104326	104187	104169	104242	104362	104680	105089	105252	106430	106550	105492	105119	104843	104584],[-3031336	-3031571	-3031962	-3032226	-3032425	-3032833	-3032966	-3032906	-3032208	-3031403	-3030753	-3030705	-3030819	-3031060]); 

for k=341:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[101956	104404	106000	103958	103484	103078	102645	102348	102213	102158],[-3030752	-3032713	-3030765	-3029264	-3029331	-3029413	-3029616	-3029764	-3030211	-3030617]); 

for k=430:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 237 

trim = ~rock & inpolygon_map(x,y,[126270	126082	126172	126441	126629	126889	127068	127301	127696	127929	128090	128216	128288	129014	129274	129435	129695	129938	130296	130556	130771	130996	131121	131130	128835	127032],[-3052448	-3052681	-3053470	-3053551	-3053479	-3053542	-3053542	-3053470	-3053551	-3053488	-3053407	-3052986	-3052887	-3052941	-3052986	-3053156	-3053407	-3053353	-3053237	-3053048	-3052735	-3052421	-3052331	-3051999	-3051829	-3052089]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[129651      129973      130413      130780      131256      131273      131058],[-3053335    -3053577    -3053461    -3053416    -3052896    -3052618    -3052170]); 

for k=346:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[129435	129417	129713	129982	130332	130619	130924	131139	131309	131533	131587	131695	131785	130951	129812],[-3052788	-3053102	-3053515	-3053793	-3053775	-3053649	-3053577	-3053542	-3053443	-3053138	-3053084	-3052914	-3052600	-3052412	-3052484]); 

for k=454:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 243 

trim = sometimes_ice & inpolygon_map(x,y,[120507	120475	120810	121717	122278	122207	122052	121846	121672	121383	121228	121170	121029	120823	120694	120687],[-3112256	-3112610	-3113486	-3113524	-3112719	-3112327	-3112307	-3112159	-3112275	-3112262	-3112249	-3112076	-3111966	-3111940	-3111985	-3112146]); 

for k=1:length(t) 
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


trim = sometimes_ice & inpolygon_map(x,y,[120533	120462	120958	122065	122342	122213	122052	121936	121634	121132	120810],[-3111689	-3112649	-3113679	-3113679	-3112372	-3111792	-3111760	-3111612	-3111625	-3111670	-3111593]); 

for k=366:length(t) 
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = sometimes_ice & inpolygon_map(x,y,[120455	120485	122356	122188	122067	121876	121702	121565	121223	121177	120789	120622],[-3111386	-3112808	-3112831	-3111523	-3111470	-3111371	-3111310	-3111196	-3111143	-3111013	-3111150	-3111264]); 

for k=416:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 244 

trim =  inpolygon_map(x,y,[  116436      116887      117718      117652      117223      117154      116977      116445],[-3116925    -3116928    -3115562    -3115093    -3115141    -3115444    -3115874    -3116633]); 

for k=1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 247

trim =  inpolygon_map(x,y,[105908	107755	108344	109108	107603	107356	106975	106767	106615	106458	106295	106183	106054],[-3139475	-3140300	-3139475	-3137847	-3137297	-3137499	-3137431	-3137532	-3137549	-3137886	-3138240	-3138588	-3139042]); 

for k=  354:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 248

trim =  inpolygon_map(x,y,[112602	112566	112623	112687	112948	113090	113203	113387	113507	113592	113655	113938	114249	114277	113719	113040],[-3145569	-3145859	-3146170	-3146396	-3146658	-3146764	-3146771	-3146615	-3146580	-3146424	-3146255	-3145965	-3145689	-3145307	-3144954	-3145046]); 

for k=  1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  inpolygon_map(x,y,[111972	112057	112142	112291	112390	112609	113033	113478	113790	114044	113507	112573],[-3145654	-3146290	-3146743	-3147096	-3147216	-3147188	-3146948	-3146594	-3146368	-3146085	-3145640	-3145576]); 

for k=  378:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 253 

trim =  inpolygon_map(x,y,[68198	68280	73985	75270	73657	72397	68820	68673	68346	68067	68157	68198	68018],[-3194635	-3194847	-3194913	-3192286	-3191680	-3192433	-3193300	-3193521	-3193620	-3193792	-3193931	-3194127	-3194332]); 

for k=  380:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  inpolygon_map(x,y,[67617	67752	68315	68301	67928	67646	67097	67071	67210	67241	67253],[-3194693	-3194829	-3194809	-3193712	-3193668	-3193599	-3193683	-3194029	-3194295	-3194474	-3194624]); 

for k=  569:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 258 

trim =  ice_sum>0 & inpolygon_map(x,y,[66380	66331	66371	66595	66889	67055	67270	67368	67593	69783	69920	66772],[-3239044	-3239249	-3239474	-3239699	-3239738	-3239728	-3239718	-3239757	-3239748	-3239337	-3238555	-3238731]); 

for k=  578:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 259 

trim =  ice_sum>0 & inpolygon_map(x,y,[45608	46784	47048	47088	46405	46251	46159	46113	46032	45981	45832	45682],[-3250872	-3251165	-3250976	-3250402	-3249817	-3249931	-3250035	-3250126	-3250373	-3250476	-3250505	-3250654]); 

for k=  325:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[45533	45424	45688	46589	46279	45958	45900	45814	45671	45579],[-3250454	-3250781	-3251016	-3249989	-3249696	-3249822	-3249897	-3249960	-3250115	-3250287]); 

for k=  347:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[45367       45281       45304       45619       46291       45711       45476],[ -3250149    -3250362    -3250499    -3250563    -3249736    -3249547    -3249736]); 

for k=  576:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 261 

trim =  ice_sum>0 & inpolygon_map(x,y,[27472	27504	28010	28770	28686	28602	28359	28200	27704],[-3231753	-3232176	-3232999	-3232355	-3231954	-3231848	-3231553	-3231416	-3231394]); 

for k=  395:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[27819       28667       29033       29004       28792       28561       28339       28166],[ -3231437    -3232045    -3231910    -3231572    -3231447    -3231341    -3231322    -3231331]); 

for k=  457:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 262 

trim =  ice_sum>0 & inpolygon_map(x,y,[  -3028       -4835       -3316        -750],[-3182201    -3183536    -3185997    -3184138]); 

for k=  493:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end


%% 265

trim =  ice_sum>0 & inpolygon_map(x,y,[ -61669      -58958      -58468      -58550      -60436      -61234      -61569      -61642],[ -3179641    -3181001    -3179178    -3178916    -3178235    -3178399    -3178653    -3179070]); 

for k=  339:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[-61914      -62349      -62576      -62676      -62667      -62567      -61533      -60962],[ -3178099    -3178335    -3178707    -3179033    -3179360    -3179659    -3179949    -3178235]); 

for k=  408:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 267 

trim =  ice_sum>0 & inpolygon_map(x,y,[ -112922     -110880     -108281     -108520     -109076     -109687     -110270     -111941],[-3207233    -3209195    -3206013    -3205429    -3204713    -3204846    -3205111    -3205827]); 

for k=  431:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[-108612	-107972	-107972	-107883	-107896	-108110	-108378	-108584	-108797	-109045	-109499],[-3206227	-3205621	-3205388	-3205147	-3204803	-3204542	-3204356	-3204329	-3204287	-3204294	-3204748]); 

for k=  467:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 273 

trim =  ice_sum>0 & inpolygon_map(x,y,[-232935	-232116	-231442	-231003	-230754	-230374	-229993	-229320	-228837	-228544	-228324	-228032	-228046	-228105	-228500	-229144	-229481	-229935	-230037	-230374	-230666	-233916	-236068	-238293	-236404],[-2818694	-2818650	-2818767	-2818577	-2818519	-2818548	-2818328	-2817889	-2817831	-2817699	-2817318	-2816982	-2816543	-2816060	-2815899	-2815752	-2815313	-2815020	-2814567	-2814274	-2813835	-2810878	-2811156	-2813644	-2817377]); 

for k=  1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[-231852	-229173	-228266	-227651	-226861	-226202	-226465	-227153	-227754	-228251	-228778	-229100	-229232	-229261	-229598	-231325	-233740],[-2820114	-2819763	-2819660	-2819397	-2819426	-2818885	-2816557	-2816513	-2816089	-2815825	-2815298	-2814801	-2814376	-2813966	-2813498	-2813381	-2818694]);

for k=  384:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 275

rock(inpolygon_map(x,y,[-247593	-247196	-246437	-245886	-245611	-244201	-242824	-241833	-241844	-242285	-242604	-242847	-243331	-243750	-244300	-244807	-245126	-246822],[-2779001	-2779629	-2780862	-2781479	-2781710	-2782272	-2782261	-2781996	-2778704	-2778329	-2778021	-2777536	-2777195	-2776864	-2776413	-2775983	-2775807	-2777382])) = false; 

filler = ~rock & inpolygon_map(x,y,[-247847	-245832	-245475	-244589	-242862	-241538	-241216	-241319	-244646	-244658	-245165	-245406	-245648	-245959	-246396	-247064	-247617],[-2779144	-2781654	-2781654	-2782057	-2782218	-2781850	-2778776	-2778269	-2775909	-2776185	-2776784	-2777279	-2777774	-2778143	-2778534	-2778822	-2779006]); 

for k = 1:length(t)
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 
end

trim =  ice_sum>0 & inpolygon_map(x,y,[-247993	-247736	-247325	-246613	-245952	-245673	-245519	-245225	-245108	-245255	-246216	-249425	-249146],[-2779115	-2778894	-2778836	-2778535	-2777874	-2777059	-2776714	-2776303	-2775994	-2775502	-2774049	-2774041	-2779261]);

for k=  1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-247628	-247398	-247007	-246558	-245993	-245498	-245337	-245118	-244992	-244946	-244888	-244612	-244462	-246419	-249401	-249275],[-2779513	-2779409	-2779363	-2779190	-2778753	-2778120	-2777843	-2777728	-2777279	-2776865	-2776646	-2776301	-2775898	-2773802	-2776347	-2778891]); 

for k=  392:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-247087	-246845	-246489	-246258	-245924	-245671	-245487	-245188	-244980	-244969	-244877	-244612	-244693	-247214	-247859],[-2780169	-2780157	-2780238	-2780019	-2779674	-2779305	-2778649	-2778131	-2777613	-2777037	-2776680	-2776381	-2775633	-2776496	-2779939]); 

for k=  452:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-246155	-245740	-245245	-244485	-244013	-243507	-243219	-242966	-243115	-243322	-242989	-242781	-242632	-243184	-243553	-243910	-244739	-247271],[-2781470	-2781378	-2781493	-2781815	-2781930	-2781884	-2781735	-2781032	-2780537	-2780180	-2779858	-2779087	-2778592	-2777774	-2777429	-2776865	-2776174	-2780111]); 

for k=  512:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-243346	-242989	-242401	-241929	-241711	-241780	-242401	-242390	-242286	-242263	-242724	-243046	-243242	-244025	-246431	-243449],[-2782483	-2782115	-2781850	-2781619	-2781343	-2780802	-2780503	-2780008	-2779559	-2778845	-2778315	-2777866	-2776991	-2776485	-2781435	-2782828]);

for k=  572:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-243484	-241653	-241204	-240721	-240721	-241054	-241262	-241054	-240939	-241515	-242206	-242770	-244704],[-2782828	-2782253	-2781792	-2781332	-2780745	-2780169	-2779639	-2779582	-2779363	-2778810	-2778511	-2777993	-2782517]); 
for k=  586:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 278 Jakobshavn 

filler = sometimes_ice & inpolygon_map(x,y,[-202361	-202402	-201931	-199062	-191072	-185992	-183861	-184639	-188962	-191298	-194453	-195231	-194391	-193982	-193777	-193961	-194514	-195170	-196092	-197198	-198325	-200128	-200968],[-2273773	-2274859	-2278895	-2280882	-2280124	-2277481	-2274633	-2269778	-2266705	-2266623	-2266602	-2267319	-2268098	-2269184	-2270065	-2271109	-2272236	-2273138	-2273875	-2274285	-2274244	-2274305	-2274428]); 

for k=1:336
    tmp = ice(:,:,k); 
    tmp(filler) = true; 
    ice(:,:,k) = tmp; 

end

trim =  ~rock & inpolygon_map(x,y,[-203918	-204307	-202320	-201787	-201295	-200619	-200107	-200292	-200886	-200558	-199984	-199595	-199472	-199615	-199554	-199431	-199349	-199493	-199390	-199677	-199738	-200230	-200517	-202217],[-2265947	-2273240	-2273322	-2273957	-2274121	-2273937	-2273773	-2273322	-2273076	-2272380	-2271622	-2271212	-2270638	-2269921	-2269614	-2269307	-2268815	-2268385	-2268036	-2267709	-2267258	-2266951	-2266500	-2266008]); 
for k=  348:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-202771	-201070	-199656	-199021	-198202	-197116	-196440	-195498	-194781	-194391	-194535	-194719	-195149	-195272	-196051	-197075	-200927],[-2273302	-2274469	-2275289	-2275227	-2274654	-2274326	-2273732	-2273056	-2272441	-2271560	-2269757	-2268999	-2268467	-2267811	-2267258	-2266520	-2266049]);
for k=  360:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-198530	-197218	-196317	-195211	-194166	-193592	-192875	-191380	-190704	-190273	-190458	-190089	-190335	-190663	-191257	-192179	-193838	-195067	-196030],[-2274736	-2274326	-2274633	-2274961	-2275043	-2274859	-2274797	-2274428	-2273670	-2273015	-2272216	-2271417	-2270331	-2269880	-2269204	-2269020	-2268118	-2267770	-2267237]);
for k=  384:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-202627	-202566	-199718	-195416	-190806	-190663	-189495	-189147	-189167	-189208	-189392	-189925	-190478	-190335	-190027	-189372	-188819	-188983	-189413	-189905	-190745	-191523	-192281	-193449	-193674	-201336],[-2273547	-2275391	-2280759	-2280411	-2276682	-2276293	-2276252	-2276006	-2275330	-2274510	-2274121	-2273322	-2272667	-2272093	-2271642	-2271519	-2271335	-2270556	-2269942	-2269491	-2269225	-2268958	-2268344	-2267504	-2266787	-2266234]);
for k=  417:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-202299	-202402	-201316	-199247	-190929	-190683	-189823	-188819	-188020	-186954	-186381	-186196	-186668	-186647	-186401	-186299	-187794	-188901	-189495	-190908	-191933	-196891	-201992],[-2273834	-2274797	-2278792	-2281210	-2276907	-2276436	-2276313	-2276108	-2275514	-2274060	-2272789	-2272072	-2271355	-2270864	-2270290	-2269532	-2268200	-2267586	-2267299	-2267586	-2267012	-2266479	-2266254]); 
for k=  441:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-191687	-190929	-190499	-189024	-188450	-187426	-186647	-186381	-186053	-185705	-185520	-185377	-185315	-185336	-185152	-185295	-185582	-185889	-185971	-185766	-185787	-185602	-185705	-186114	-186831	-187364	-188204	-189085	-189536	-190007	-190478	-191769	-193101	-193367],[-2277235	-2276723	-2276334	-2276231	-2276190	-2276252	-2276354	-2275883	-2275432	-2274777	-2274265	-2273629	-2273015	-2272728	-2272380	-2271929	-2271601	-2271232	-2270782	-2270126	-2269696	-2269286	-2268467	-2267975	-2267504	-2267319	-2267135	-2266889	-2267074	-2267258	-2267094	-2266828	-2267033	-2274633]);
for k=  549:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-189117	-187714	-186522	-186349	-185869	-185619	-185657	-185138	-184984	-185119	-184984	-184984	-185926	-186291	-186195	-185619	-185407	-185080	-185196	-186042	-186983	-187772	-188444	-189309],[-2276105	-2276105	-2276066	-2275759	-2275432	-2275009	-2274528	-2274278	-2273779	-2273144	-2272568	-2272029	-2271376	-2270857	-2270107	-2269396	-2268781	-2268415	-2268031	-2267377	-2267031	-2266935	-2266801	-2266974]); 
for k=  561:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim =  ~rock & inpolygon_map(x,y,[-188829	-187772	-186522	-185734	-184850	-184254	-184023	-184004	-183754	-184312	-184581	-185407	-186215	-185465	-184888	-184715	-184754	-185292	-186464	-187156	-188002	-188368	-189098	-189867],[-2276124	-2276181	-2276431	-2276297	-2276181	-2275720	-2274990	-2274355	-2273529	-2272683	-2272049	-2271683	-2270914	-2269492	-2268877	-2267877	-2267224	-2266878	-2266724	-2266512	-2266589	-2266666	-2266628	-2267185]);
for k=  573:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[-190021	-188348	-187156	-186080	-185638	-184850	-184312	-183831	-183389	-183562	-184062	-184350	-184888	-185715	-185869	-185599	-185023	-184754	-184638	-184485	-184465	-184254	-184485	-185080	-185580	-186195	-187022	-187637	-188214	-188637	-189156	-189444	-190021],[-2276278	-2276278	-2276393	-2276489	-2276566	-2276374	-2276181	-2274990	-2274125	-2273490	-2272625	-2272202	-2271683	-2271087	-2270684	-2269953	-2269127	-2268492	-2267858	-2267243	-2266666	-2266147	-2265801	-2265705	-2265628	-2265763	-2265974	-2266243	-2266359	-2266301	-2266551	-2266685	-2267166]);
for k=  585:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 287

trim = ~rock & inpolygon_map(x,y,[  -211380     -211372     -208205     -208146     -209801],[-2093408    -2094725    -2094598    -2093560    -2093408]); 
for k=  1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 288

trim = ~rock & inpolygon_map(x,y,[-215702	-215652	-211739	-209909	-210786	-210912	-211489	-211890	-212291	-212818	-213219	-214373],[-2087728	-2090186	-2092544	-2088707	-2088305	-2088155	-2088105	-2087754	-2087202	-2086976	-2086700	-2086750]); 

for k=  456:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% 291

trim = ~rock & inpolygon_map(x,y,[-229034	-228737	-228412	-227970	-227807	-227762	-227717	-227843	-227943	-227825	-227446	-226887	-226354	-225741	-225244	-225019	-224550	-224378	-224270	-224071	-225272	-226445	-227852	-229901	-231236	-230839],[-2013584	-2013494	-2013467	-2013557	-2013530	-2013115	-2012817	-2012502	-2012159	-2011861	-2011753	-2011635	-2011644	-2011563	-2011680	-2011662	-2011437	-2011112	-2010724	-2009948	-2009036	-2008703	-2009027	-2010092	-2012538	-2013702]); 

for k=  1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[-228403	-227636	-227546	-227618	-227518	-227672	-227663	-227663	-227076	-226661	-226327	-226020	-225614	-225488	-225055	-224613	-224342	-224216	-224189	-224134	-224107	-225551	-228601	-229350	-229161],[-2014054	-2014000	-2013657	-2013007	-2012817	-2012447	-2012240	-2011951	-2011780	-2011698	-2011735	-2011608	-2011635	-2011698	-2011762	-2011662	-2011608	-2011337	-2010968	-2010543	-2010128	-2010056	-2010841	-2012808	-2014144]);
for k=  365:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

trim = ~rock & inpolygon_map(x,y,[-224893     -224477     -224008     -223792     -223846     -223945     -223774     -224189],[-2011762    -2011726    -2011762    -2011635    -2011428    -2011049    -2010543    -2010083]); 

for k=  550:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end

%% Remove the thin bits of ice along fjord edges

ever_ice = any(ice,3); 

% Not part of the opened data means only thin bits of ice; max 70 pixels removes pixels that are part of a >1 km^2 unit.  
trim = ~imopen(ever_ice,[0 1 0; 1 1 1; 0 1 0]) & bwareafilt(ever_ice,[1 70]); 

for k=  1:length(t)
    tmp = ice(:,:,k); 
    tmp(trim) = false; 
    ice(:,:,k) = tmp; 
end